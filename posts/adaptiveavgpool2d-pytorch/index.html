<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>AdaptiveAvgPool2d in PyTorch - Thoughts - Ambarish</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta itemprop="name" content="AdaptiveAvgPool2d in PyTorch">
<meta itemprop="description" content="AdaptiveAvgPool2d in PyTorch"><meta itemprop="datePublished" content="2021-04-18T00:00:00&#43;00:30" />
<meta itemprop="dateModified" content="2021-04-18T00:00:00&#43;00:30" />
<meta itemprop="wordCount" content="387">
<meta itemprop="keywords" content="deeplearning,pytorch," /><meta property="og:title" content="AdaptiveAvgPool2d in PyTorch" />
<meta property="og:description" content="AdaptiveAvgPool2d in PyTorch" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/adaptiveavgpool2d-pytorch/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-18T00:00:00&#43;00:30" />
<meta property="article:modified_time" content="2021-04-18T00:00:00&#43;00:30" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="AdaptiveAvgPool2d in PyTorch"/>
<meta name="twitter:description" content="AdaptiveAvgPool2d in PyTorch"/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="/js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="/">Thoughts - Ambarish</a></h1>
	<div class="site-description"><p></p><nav class="nav social">
			<ul class="flat"><li><a href="mailto:ambarish.ganguly@gmail.com" title="Email"><i data-feather="mail"></i></a></li><li><a href="https://www.linkedin.com/in/ambarish-ganguly/" title="LinkedIn"><i data-feather="linkedin"></i></a></li><li><a href="https://twitter.com/a_ganguly/" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://github.com/ambarishg" title="Github"><i data-feather="github"></i></a></li><li><a href="/index.xml" title="RSS"><i data-feather="rss"></i></a></li><li><a href="#" class="scheme-toggle" id="scheme-toggle"></a></li></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">Home</a>
			</li>
			
			<li>
				<a href="/posts">All posts</a>
			</li>
			
			<li>
				<a href="/about">About</a>
			</li>
			
			<li>
				<a href="/tags">Tags</a>
			</li>
			
			<li>
				<a href="/books">Books</a>
			</li>
			
			<li>
				<a href="/awards/">Awards</a>
			</li>
			
			<li>
				<a href="/testimonials/">Testimonials</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">18</span>
							<span class="rest">Apr 2021</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">AdaptiveAvgPool2d in PyTorch</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>I had trouble understanding the <code>AdaptiveAvgPool2d</code> function in PyTorch.  The following examples helped me to teach myself better. Hopefully, somebody may benefit from this.</p>
<h1 id="example-1">Example 1</h1>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#00f">import</span> torch
<span style="color:#00f">import</span> torch.nn <span style="color:#00f">as</span> nn
<span style="color:#00f">import</span> numpy <span style="color:#00f">as</span> np

m = nn.AdaptiveAvgPool2d((1))

x = np.array(
[
    [ 2. , 3.],
    [ 4. , 1.],
    
])

input = torch.tensor(x)
<span style="color:#00f">print</span>(input)

output = m(input)
<span style="color:#00f">print</span>(output)
<span style="color:#00f">print</span>(torch.mean(input))
</code></pre></div><p>The output will be equal to torch.mean(input)</p>
<h1 id="example-2-with-a-3-x-3-x-3--tensor">Example 2 with a 3 x 3 x 3  tensor</h1>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x = np.array(
[
    [
        [ 2. , 3. , 2.],
        [ 2. , 3. , 2.],
        [ 2. , 3. , 2.],
    
    ],
    
    [
        [ 1. , 4. , 5.],
        [ 1. , 4. , 5.],
        [ 1. , 4. ,  5. ],
    
    ],
    
    [
        [ 7. , 3. , 2.],
        [ 7. , 3. , 2.],
        [ 7. , 3. , 2.],
    
    ]

])
</code></pre></div><p>This is a 3 x 3  x 3 array</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
input = torch.tensor(x)

m = nn.AdaptiveAvgPool2d((2))

output = m(input)

<span style="color:#00f">print</span>(output)

</code></pre></div><p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/kgj93iaxv1pj74s030uq.png" alt="image"></p>
<p>Let&rsquo;s investigate why the 1st element is 2.5</p>
<p>We take a 2 x 2 tensor out of the 3 x 3 x 3 tensor and take the mean and see that it is 2.5</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x2 = torch.tensor(np.array([2. , 3. , 2. , 3.]))
torch.mean(x2)
</code></pre></div><p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/t8rxef2kvh1vw7cie79e.png" alt="image"></p>
<h2 id="example-3">Example 3</h2>
<p>We see that the 6th element is 4.5. How is this calculated?</p>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/ih0u38c6uuikwqlaojvd.png" alt="image"></p>
<p>We take the mean of the following section</p>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/kg7za5rzu6m32ptcguql.png" alt="image"></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x3 = torch.tensor(np.array([ 4.0 , 5. , 4. , 5.]))
torch.mean(x3)
</code></pre></div><h1 id="example-4---with-a-4-x-3-x-3-tensor">Example 4   with a 4 x 3 x 3 tensor</h1>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
x = np.array(
[
    [
        [ 2. , 3. , 2.],
        [ 2. , 3. , 2.],
        [ 2. , 3. , 2.],
    
    ],
    
    [
        [ 1. , 4. , 5.],
        [ 1. , 4. , 5.],
        [ 1. , 4. ,  5. ],
    
    ],
    
    [
        [ 7. , 3. , 2.],
        [ 7. , 3. , 2.],
        [ 7. , 3. , 2.],
    
    ],
    
    [
        [ 8. , 3. , 2.],
        [ 8. , 3. , 2.],
        [ 8. , 3. , 2.],
    
    ]

])

input = torch.tensor(x)
<span style="color:#00f">print</span>(input)
<span style="color:#00f">print</span>(input.shape)
</code></pre></div><p>This is a 4 x 3 x 3 tensor</p>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/hrpawg4zi1yw56np15bc.png" alt="image"></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
m = nn.AdaptiveAvgPool2d([1,1])
output= m(input)
<span style="color:#00f">print</span>(output)
</code></pre></div><p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/k1qn2m7q67e96hy39937.png" alt="image"></p>
<p>Let us explore why the first element is <strong>2.3333</strong></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x4 = torch.tensor(
    np.array( [ 2. , 3. , 2.,  2. , 3. , 2.,  2. , 3. , 2.])
                 )
<span style="color:#00f">print</span>(torch.mean(x4))
</code></pre></div><p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/4lck8u8gkwepfyur9el3.png" alt="image"></p>

			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="/tags/deeplearning">deeplearning</a></li>
							
							<li><a href="/tags/pytorch">pytorch</a></li>
							
						</ul>
					
				
			</div><div id="disqus_thread"></div>
<script type="text/javascript">
	(function () {
		
		
		if (window.location.hostname == "localhost")
			return;

		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		var disqus_shortname = 'ink-demo';
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the </a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2021  Â© Copyright notice |  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-113191180-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
