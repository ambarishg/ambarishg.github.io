[
["index.html", "Little Book on Data Visualization and Time series Forecasts Chapter 1 Introduction 1.1 Live version", " Little Book on Data Visualization and Time series Forecasts Ambarish Ganguly Chapter 1 Introduction This is a Little Book on Data Visualization , Maps and Time series Forecasts on the Kaggle Dataset Crime in LA. We do Exploratory Data analysis on various topics such as the Month of Crime ,Day of Crime,Time of Crime. We also explore how the Crimes are related to the Sex and Age of the Victims, Crime Types, Crime Types of persons aged 70 and above. We explore on the Crimes at different Premises,Types of Crimes at different Premises,victim Descent Analysis and an analysis of Weapons used in Crime. We explore the various Maps where the Crime has occurred. We do Time series forecasting for the most commonly occurring crime type Simple Assault using different Time Series forecasting techniques such as Arima, ETS and Prophet. 1.1 Live version If you wish to have a peek of the end result, you can view this in LA Crime Report "],
["prepare-for-analysis.html", "Chapter 2 Prepare for Analysis 2.1 Install the Software 2.2 Install the packages 2.3 Create a R project 2.4 Get the Data", " Chapter 2 Prepare for Analysis 2.1 Install the Software Install R Install the R Studio 2.2 Install the packages Install the following packages by running the command install.packages(“YourPackageName”) library(tidyverse) library(leaflet) library(stringr) library(rgdal) library(lubridate) library(forecast) library(kableExtra) library(prophet) Also do the following for proper formatting of the Datatable install.packages(‘webshot’) webshot::install_phantomjs() 2.3 Create a R project Open R Studio and create a New Project. Create a folder input in the New project. Create a folder code where you can put all your code files. 2.4 Get the Data Get the data from Kaggle. Put all the files in the input folder of the project. Learning Check Make sure you have installed all the packages Make sure you have downloaded all the files "],
["read-the-data.html", "Chapter 3 Read the Data 3.1 Peek into the data", " Chapter 3 Read the Data Read the CrimeData using the function read_csv. library(tidyverse) library(leaflet) library(stringr) library(rgdal) library(lubridate) library(forecast) library(knitr) library(kableExtra) library(prophet) library(webshot) rm(list=ls()) fillColor = &quot;#FFA07A&quot; fillColor2 = &quot;#F1C40F&quot; LACrime = read_csv(&quot;input/Crime_Data_2010_2017.csv&quot;) 3.1 Peek into the data kable(head(LACrime),&quot;html&quot;) %&gt;% kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) %&gt;% scroll_box(width = &quot;800px&quot;) DR Number Date Reported Date Occurred Time Occurred Area ID Area Name Reporting District Crime Code Crime Code Description MO Codes Victim Age Victim Sex Victim Descent Premise Code Premise Description Weapon Used Code Weapon Description Status Code Status Description Crime Code 1 Crime Code 2 Crime Code 3 Crime Code 4 Address Cross Street Location 1208575 03/14/2013 03/11/2013 1800 12 77th Street 1241 626 INTIMATE PARTNER - SIMPLE ASSAULT 0416 0446 1243 2000 30 F W 502 MULTI-UNIT DWELLING (APARTMENT, DUPLEX, ETC) 400 STRONG-ARM (HANDS, FIST, FEET OR BODILY FORCE) AO Adult Other 626 NA NA NA 6300 BRYNHURST AV NA (33.9829, -118.3338) 102005556 01/25/2010 01/22/2010 2300 20 Olympic 2071 510 VEHICLE - STOLEN NA NA NA NA 101 STREET NA NA IC Invest Cont 510 NA NA NA VAN NESS 15TH (34.0454, -118.3157) 418 03/19/2013 03/18/2013 2030 18 Southeast 1823 510 VEHICLE - STOLEN NA 12 NA NA 101 STREET NA NA IC Invest Cont 510 NA NA NA 200 E 104TH ST NA (33.942, -118.2717) 101822289 11/11/2010 11/10/2010 1800 18 Southeast 1803 510 VEHICLE - STOLEN NA NA NA NA 101 STREET NA NA IC Invest Cont 510 NA NA NA 88TH WALL (33.9572, -118.2717) 42104479 01/11/2014 01/04/2014 2300 21 Topanga 2133 745 VANDALISM - MISDEAMEANOR ($399 OR UNDER) 0329 84 M W 501 SINGLE FAMILY DWELLING NA NA IC Invest Cont 745 NA NA NA 7200 CIRRUS WY NA (34.2009, -118.6369) 120125367 01/08/2013 01/08/2013 1400 1 Central 111 110 CRIMINAL HOMICIDE 1243 2000 1813 1814 2002 0416 0400 49 F W 501 SINGLE FAMILY DWELLING 400 STRONG-ARM (HANDS, FIST, FEET OR BODILY FORCE) AA Adult Arrest 110 NA NA NA 600 N HILL ST NA (34.0591, -118.2412) "],
["latitude-and-longitude.html", "Chapter 4 Latitude and Longitude", " Chapter 4 Latitude and Longitude The Location field has the format (Latitude,Longitude). We create 2 fields Latitude and Longitude from the Location field. We would be using these newly formed fields in the maps shown below. LACrime_latlong = gsub(&#39;\\\\(&#39;,&#39;&#39;,LACrime$Location) LACrime_latlong = gsub(&#39;\\\\)&#39;,&#39;&#39;,LACrime_latlong) LACrime_latlong = str_split(LACrime_latlong,&quot;,&quot;) LACrime_latlong = do.call(rbind.data.frame, LACrime_latlong) colnames(LACrime_latlong) = c(&quot;latitude&quot;,&quot;longitude&quot;) LACrime$latitude = as.numeric(as.character(LACrime_latlong$latitude)) LACrime$longitude = as.numeric(as.character(LACrime_latlong$longitude)) rm(LACrime_latlong) LACrime = LACrime %&gt;% select(-Location) "],
["rename-the-fields-to-remove-spaces-in-between-fields.html", "Chapter 5 Rename the Fields to remove Spaces in between Fields", " Chapter 5 Rename the Fields to remove Spaces in between Fields LACrime = LACrime %&gt;% rename(DRNumber = `DR Number`) %&gt;% rename(DateReported = `Date Reported`) %&gt;% rename(DateOccurred = `Date Occurred`) %&gt;% rename(TimeOccurred = `Time Occurred`) %&gt;% rename(AreaID = `Area ID`) %&gt;% rename(AreaName = `Area Name`) %&gt;% rename(ReportingDistrict = `Reporting District`) %&gt;% rename(CrimeCode = `Crime Code`) %&gt;% rename(CrimeCodeDescription = `Crime Code Description`) %&gt;% rename(MOCodes = `MO Codes`) %&gt;% rename(VictimAge = `Victim Age`) %&gt;% rename(VictimSex = `Victim Sex`) %&gt;% rename(VictimDescent = `Victim Descent`) %&gt;% rename(PremiseCode = `Premise Code`) %&gt;% rename(PremiseDescription = `Premise Description`) %&gt;% rename(WeaponUsedCode = `Weapon Used Code`) %&gt;% rename(WeaponDescription = `Weapon Description`) %&gt;% rename(StatusCode = `Status Code`) %&gt;% rename(StatusDescription = `Status Description`) %&gt;% rename(CrimeCode1 = `Crime Code 1`) %&gt;% rename(CrimeCode2 = `Crime Code 2`) %&gt;% rename(CrimeCode3 = `Crime Code 3`) %&gt;% rename(CrimeCode4 = `Crime Code 4`) %&gt;% rename(CrossStreet = `Cross Street`) "],
["month-of-crime.html", "Chapter 6 Month of Crime", " Chapter 6 Month of Crime We examine the months in which Crime has occurred and create a bar plot. LACrime$MonthOfCrime = month.abb[month(mdy(LACrime$DateOccurred))] LACrime %&gt;% group_by(MonthOfCrime) %&gt;% summarise(CountIncidents = n()) %&gt;% mutate(MonthOfCrime = reorder(MonthOfCrime,CountIncidents)) %&gt;% ggplot(aes(x = MonthOfCrime,y = CountIncidents)) + geom_bar(stat=&#39;identity&#39;,colour=&quot;white&quot;, fill =fillColor) + geom_text(aes(x = MonthOfCrime, y = 1, label = paste0(&quot;(&quot;,CountIncidents,&quot;)&quot;,sep=&quot;&quot;)), hjust=0, vjust=.5, size = 4, colour = &#39;black&#39;, fontface = &#39;bold&#39;) + labs(x = &#39;Month Of Crime&#39;, y = &#39;Count of Incidents&#39;, title = &#39;Count of Incidents&#39;) + coord_flip() + theme_bw() We observe that the months of November and December have the lowest crimes. "],
["day-of-crime.html", "Chapter 7 Day of Crime", " Chapter 7 Day of Crime We examine the days in which Crime has occurred and create a bar plot. LACrime$DayOfCrime = wday(mdy(LACrime$DateOccurred),label = TRUE) LACrime %&gt;% group_by(DayOfCrime) %&gt;% summarise(CountIncidents = n()) %&gt;% mutate(DayOfCrime = reorder(DayOfCrime,CountIncidents)) %&gt;% ggplot(aes(x = DayOfCrime,y = CountIncidents)) + geom_bar(stat=&#39;identity&#39;,colour=&quot;white&quot;, fill =fillColor2) + geom_text(aes(x = DayOfCrime, y = 1, label = paste0(&quot;(&quot;,CountIncidents,&quot;)&quot;,sep=&quot;&quot;)), hjust=0, vjust=.5, size = 4, colour = &#39;black&#39;, fontface = &#39;bold&#39;) + labs(x = &#39;Day Of Crime&#39;, y = &#39;Count of Incidents&#39;, title = &#39;Count of Incidents&#39;) + coord_flip() + theme_bw() We observe that Friday has the highest crimes. "],
["time-of-crime.html", "Chapter 8 Time of Crime 8.1 Most Crimes 8.2 Least Crimes 8.3 Crime Types at 1200 hrs", " Chapter 8 Time of Crime 8.1 Most Crimes The plot shows the hours of the day where most crimes occur. LACrime %&gt;% group_by(TimeOccurred) %&gt;% summarise(CountIncidents = n()) %&gt;% arrange(desc(CountIncidents)) %&gt;% mutate(TimeOccurred = as.integer(TimeOccurred)) %&gt;% mutate(TimeOccurred = reorder(TimeOccurred,CountIncidents)) %&gt;% head(10) %&gt;% ggplot(aes(x = TimeOccurred,y = CountIncidents)) + geom_bar(stat=&#39;identity&#39;,colour=&quot;white&quot;, fill =fillColor) + geom_text(aes(x = TimeOccurred, y = 1, label = paste0(&quot;(&quot;,CountIncidents,&quot;)&quot;,sep=&quot;&quot;)), hjust=0, vjust=.5, size = 4, colour = &#39;black&#39;, fontface = &#39;bold&#39;) + labs(x = &#39;Time Of Crime&#39;, y = &#39;Count of Incidents&#39;, title = &#39;Count of Incidents&#39;) + coord_flip() + theme_bw() Crimes occur mostly at 1200 hrs. Very Strange!, why would someone commit crime so much at the middle of the day, rather than at night. 8.2 Least Crimes LACrime %&gt;% group_by(TimeOccurred) %&gt;% summarise(CountIncidents = n()) %&gt;% arrange(desc(CountIncidents)) %&gt;% mutate(TimeOccurred = as.integer(TimeOccurred)) %&gt;% mutate(TimeOccurred = reorder(TimeOccurred,CountIncidents)) %&gt;% tail(10) %&gt;% ggplot(aes(x = TimeOccurred,y = CountIncidents)) + geom_bar(stat=&#39;identity&#39;,colour=&quot;white&quot;, fill =fillColor) + geom_text(aes(x = TimeOccurred, y = 1, label = paste0(&quot;(&quot;,CountIncidents,&quot;)&quot;,sep=&quot;&quot;)), hjust=0, vjust=.5, size = 4, colour = &#39;black&#39;, fontface = &#39;bold&#39;) + labs(x = &#39;Time Of Crime&#39;, y = &#39;Count of Incidents&#39;, title = &#39;Count of Incidents&#39;) + coord_flip() + theme_bw() Crimes occur least at round 700 hrs. Is it because, people have woken up and getting ready for crime ? This is really interesting. 8.3 Crime Types at 1200 hrs We examine the different crime types that occur at 1200 hrs since this is the time most crimes occur. LACrime %&gt;% filter(TimeOccurred == 1200) %&gt;% group_by(CrimeCodeDescription) %&gt;% summarise(CountIncidents = n()) %&gt;% arrange(desc(CountIncidents)) %&gt;% mutate(CrimeCodeDescription = reorder(CrimeCodeDescription,CountIncidents)) %&gt;% head(10) %&gt;% ggplot(aes(x = CrimeCodeDescription,y = CountIncidents)) + geom_bar(stat=&#39;identity&#39;,colour=&quot;white&quot;, fill = c(&quot;red&quot;)) + geom_text(aes(x = CrimeCodeDescription, y = 1, label = paste0(&quot;(&quot;,CountIncidents,&quot;)&quot;,sep=&quot;&quot;)), hjust=0, vjust=.5, size = 4, colour = &#39;white&#39;, fontface = &#39;bold&#39;) + labs(x = &#39;Time Of Crime&#39;, y = &#39;Count of Incidents&#39;, title = &#39;Type of Crime at 1200 hrs&#39;) + coord_flip() + theme_bw() Theft of Identity is the most common crime type which happens during this time. "],
["sex-of-the-victims.html", "Chapter 9 Sex of the Victims", " Chapter 9 Sex of the Victims We examine the sex of the Victims in the following barplot. LACrime %&gt;% filter(!is.na(VictimSex)) %&gt;% group_by(VictimSex) %&gt;% tally() %&gt;% ungroup() %&gt;% mutate(VictimSex = reorder(VictimSex,n)) %&gt;% ggplot(aes(x = VictimSex,y = n)) + geom_bar(stat=&#39;identity&#39;,colour=&quot;white&quot;, fill =fillColor) + geom_text(aes(x = VictimSex, y = 1, label = paste0(&quot;(&quot;,n,&quot;)&quot;,sep=&quot;&quot;)), hjust=0, vjust=.5, size = 4, colour = &#39;black&#39;, fontface = &#39;bold&#39;) + labs(x = &#39;Sex&#39;, y = &#39;Count of Incidents&#39;, title = &#39;Count of Incidents and Sex&#39;) + coord_flip() + theme_bw() It is evident that there are More Males involved than the Females. "],
["age-and-sex-of-the-victims.html", "Chapter 10 Age and Sex of the Victims", " Chapter 10 Age and Sex of the Victims We examine the age and sex of the Victims involved in Crime. breaks = seq(0,100,5) ListSex = c(&quot;M&quot;,&quot;F&quot;) LACrime %&gt;% filter( VictimSex %in% ListSex ) %&gt;% ggplot(aes(VictimAge)) + geom_histogram(binwidth = 5,fill = c(&quot;red&quot;)) + facet_wrap(~ VictimSex) + scale_x_continuous(limits = c(0, 100),breaks=breaks ) + labs(x = &#39;Victim Age&#39;, y = &#39;Count of Crimes&#39;, title = &#39;Age , Sex and Crimes&#39;) + theme_bw() Most Victims are around the age 25 to 30.It is evident that Females are Victimised more than Males in the age group 25 to 30. "],
["sex-and-types-of-crime.html", "Chapter 11 Sex and Types of Crime", " Chapter 11 Sex and Types of Crime We examine the Types of Crime the males and females are being involved in. For the sake of clarity, we plot only the top Ten Sex and Crime Type numbers in the bar plot. Let’s see whether we find any interesting observation. LACrime %&gt;% filter(!is.na(VictimSex)) %&gt;% group_by(VictimSex,CrimeCodeDescription) %&gt;% tally() %&gt;% ungroup() %&gt;% mutate(VictimSex = reorder(VictimSex,n)) %&gt;% arrange(desc(n)) %&gt;% head(10) %&gt;% ggplot(aes(x = VictimSex,y = n, fill =CrimeCodeDescription)) + geom_bar(stat=&#39;identity&#39;) + labs(x = &#39;Sex and Crime Description&#39;, y = &#39;Count of Incidents&#39;, title = &#39;Count of Incidents and Sex and Crime Description&#39;) + coord_flip() + theme_bw() + theme(legend.position=&quot;top&quot;) We observe for Females we have the Category Intimate Partner - Simple Assault which we do not have for Males. "],
["crime-types-for-persons-aged-70-and-above.html", "Chapter 12 Crime Types for persons aged 70 and above", " Chapter 12 Crime Types for persons aged 70 and above We examine the Crime Types commited with persons aged 70 and above. LACrime %&gt;% filter(!is.na(VictimSex)) %&gt;% filter(VictimAge &gt;= 70) %&gt;% group_by(VictimSex,CrimeCodeDescription) %&gt;% tally() %&gt;% ungroup() %&gt;% mutate(VictimSex = reorder(VictimSex,n)) %&gt;% arrange(desc(n)) %&gt;% head(10) %&gt;% ggplot(aes(x = VictimSex,y = n,fill = CrimeCodeDescription)) + geom_bar(stat=&#39;identity&#39;) + labs(x = &#39;Sex and Crime Description&#39;, y = &#39;Count of Incidents&#39;, title = &#39;Count of Incidents and Sex and Crime Description for Persons 70 and above&#39;) + coord_flip() + theme_bw() + theme(legend.position=&quot;top&quot;) We observer that Theft of Identity and Burglary are the Two Important Crime Types commited with persons aged 70 and above. "],
["crimes-at-different-premises.html", "Chapter 13 Crimes at different Premises", " Chapter 13 Crimes at different Premises We investigate how the crimes are distributed among different places or Premises. LACrime %&gt;% filter(!is.na(PremiseDescription)) %&gt;% group_by(PremiseDescription) %&gt;% tally() %&gt;% ungroup() %&gt;% mutate(PremiseDescription = reorder(PremiseDescription,n)) %&gt;% arrange(desc(n)) %&gt;% head(20) %&gt;% ggplot(aes(x = PremiseDescription,y = n)) + geom_bar(stat=&#39;identity&#39;,colour=&quot;white&quot;, fill =fillColor2) + geom_text(aes(x = PremiseDescription, y = 1, label = paste0(&quot;(&quot;,n,&quot;)&quot;,sep=&quot;&quot;)), hjust=0, vjust=.5, size = 4, colour = &#39;black&#39;, fontface = &#39;bold&#39;) + labs(x = &#39;PremiseDescription&#39;, y = &#39;Count of Incidents&#39;, title = &#39;Count of Incidents and PremiseDescription&#39;) + coord_flip() + theme_bw() Street , Single family dwelling , Multi unit bwelling, Parking lot rank among the top places for Crimes. "],
["types-of-crimes-at-different-premises.html", "Chapter 14 Types of Crimes at different Premises", " Chapter 14 Types of Crimes at different Premises We examine the Crime Types at different Premises. LACrime %&gt;% filter(!is.na(PremiseDescription)) %&gt;% group_by(PremiseDescription,CrimeCodeDescription) %&gt;% tally() %&gt;% ungroup() %&gt;% mutate(PremiseDescription = reorder(PremiseDescription,n)) %&gt;% arrange(desc(n)) %&gt;% head(10) %&gt;% ggplot(aes(x = PremiseDescription,y = n, fill =CrimeCodeDescription)) + geom_bar(stat=&#39;identity&#39;) + labs(x = &#39;Premise Description and Crime Description&#39;, y = &#39;Count of Incidents&#39;, title = &#39;Count of Incidents and Premise Description and Crime Description&#39;) + coord_flip() + theme_bw() + theme(legend.position=&quot;bottom&quot;) Stolen Vehicle and Burglary from Vehicle are most common Crime Types in the Street. Theft of Identity and Burglary are most common Crime Types in the Single Family Dwelling. "],
["victim-descent.html", "Chapter 15 Victim Descent", " Chapter 15 Victim Descent We examine the Descent of the Victims in the barplot. VictimDescentAbbr = c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;F&quot;,&quot;G&quot;,&quot;H&quot;,&quot;I&quot;,&quot;J&quot;,&quot;K&quot;,&quot;L&quot;,&quot;O&quot;,&quot;P&quot;,&quot;S&quot;,&quot;U&quot;,&quot;V&quot;,&quot;W&quot;,&quot;X&quot;,&quot;Z&quot;) VictimDescentDescription = c(&quot;Other Asian&quot;,&quot;Black&quot;, &quot;Chinese&quot;,&quot;Cambodian&quot;,&quot;Filipino&quot;, &quot;Guamanian&quot;,&quot;Hispanic/Latin/Mexican&quot;, &quot;American Indian/Alaskan Native&quot;, &quot;Japanese&quot;,&quot;Korean&quot;,&quot;Laotian &quot;, &quot;Other&quot;,&quot;Pacific Islander&quot;, &quot;Samoan&quot;,&quot;Hawaiian&quot;,&quot;Vietnamese&quot;, &quot;White&quot;,&quot;Unknown&quot;,&quot;AsianIndian&quot;) VictimDescentFull = data.frame(VictimDescent = as.character(VictimDescentAbbr), VictimDescentDescription = as.character(VictimDescentDescription)) LACrime$VictimDescent = as.character(LACrime$VictimDescent) LACrime %&gt;% filter(!is.na(VictimDescent)) %&gt;% group_by(VictimDescent) %&gt;% tally() %&gt;% ungroup() %&gt;% arrange(desc(n)) %&gt;% inner_join(VictimDescentFull) %&gt;% head(10) %&gt;% mutate(VictimDescentDescription = reorder(VictimDescentDescription,n)) %&gt;% ggplot(aes(x = VictimDescentDescription,y = n)) + geom_bar(stat=&#39;identity&#39;,colour=&quot;white&quot;, fill =fillColor2) + geom_text(aes(x = VictimDescentDescription, y = 1, label = paste0(&quot;(&quot;,n,&quot;)&quot;,sep=&quot;&quot;)), hjust=0, vjust=.5, size = 4, colour = &#39;black&#39;, fontface = &#39;bold&#39;) + labs(x = &#39;VictimDescent&#39;, y = &#39;Count of Incidents&#39;, title = &#39;Count of Incidents and VictimDescent&#39;) + coord_flip() + theme_bw() We observe Hispanic, White and Black are the top categories where the Victims are present. "],
["weapons-in-crime.html", "Chapter 16 Weapons in Crime", " Chapter 16 Weapons in Crime We examine the waepons used in the following barplot. #WeaponDescription LACrime %&gt;% filter(!is.na(WeaponDescription)) %&gt;% group_by(WeaponDescription) %&gt;% tally() %&gt;% ungroup() %&gt;% arrange(desc(n)) %&gt;% head(10) %&gt;% mutate(WeaponDescription = reorder(WeaponDescription,n)) %&gt;% ggplot(aes(x = WeaponDescription,y = n)) + geom_bar(stat=&#39;identity&#39;,colour=&quot;white&quot;, fill =fillColor2) + geom_text(aes(x = WeaponDescription, y = 1, label = paste0(&quot;(&quot;,n,&quot;)&quot;,sep=&quot;&quot;)), hjust=0, vjust=.5, size = 4, colour = &#39;black&#39;, fontface = &#39;bold&#39;) + labs(x = &#39;Weapon Description&#39;, y = &#39;Count of Incidents&#39;, title = &#39;Count of Incidents and Weapon Description&#39;) + coord_flip() + theme_bw() "],
["map-the-crime-sites.html", "Chapter 17 Map the Crime Sites", " Chapter 17 Map the Crime Sites center_lon = median(LACrime$longitude,na.rm = TRUE) center_lat = median(LACrime$latitude,na.rm = TRUE) LACrimeSample = LACrime %&gt;% sample_n(50e3) leaflet(LACrimeSample) %&gt;% addProviderTiles(&quot;Esri.NatGeoWorldMap&quot;) %&gt;% addCircles(lng = ~longitude, lat = ~latitude, color = c(&quot;red&quot;)) %&gt;% # controls setView(lng=center_lon, lat=center_lat, zoom=10) We observe that there are clusters of areas where Crime happens. Areas like Burbank, Santa Monica, Rancho Palos Verdes,Redondo Beach have less crimes or no crimes at all. "],
["reporting-district-incidents.html", "Chapter 18 Reporting District Incidents", " Chapter 18 Reporting District Incidents We examine the Reporting Districts which report the maximum number of Crimes. The bar plot shows the Top 20 Reporting Districts which report Crimes. RDGeoLocation = LACrime %&gt;% group_by(ReportingDistrict) %&gt;% summarise(RDlat = median(latitude,na.rm = TRUE) ,RDlon = median(longitude,na.rm = TRUE) ,CountIncidents = n()) %&gt;% arrange(desc(CountIncidents)) %&gt;% head(50) head(RDGeoLocation,20) %&gt;% mutate(ReportingDistrict = reorder(ReportingDistrict,CountIncidents)) %&gt;% ggplot(aes(x = ReportingDistrict,y = CountIncidents)) + geom_bar(stat=&#39;identity&#39;,colour=&quot;white&quot;, fill =fillColor) + geom_text(aes(x = ReportingDistrict, y = 1, label = paste0(&quot;(&quot;,CountIncidents,&quot;)&quot;,sep=&quot;&quot;)), hjust=0, vjust=.5, size = 4, colour = &#39;black&#39;, fontface = &#39;bold&#39;) + labs(x = &#39;ReportingDistrict&#39;, y = &#39;Count of Incidents&#39;, title = &#39;Count of Incidents in Reporting District&#39;) + coord_flip() + theme_bw() "],
["map-of-the-reporting-district-incidents.html", "Chapter 19 Map of the Reporting District Incidents", " Chapter 19 Map of the Reporting District Incidents The Map shows the Reporting District with the circle size representing the number of incidents in the areas. leaflet(RDGeoLocation) %&gt;% addProviderTiles(&quot;Esri.NatGeoWorldMap&quot;) %&gt;% addCircles(lng = ~RDlon, lat = ~RDlat, radius = ~sqrt(CountIncidents)*30, color = c(&quot;red&quot;)) %&gt;% # controls setView(lng=center_lon, lat=center_lat, zoom=10) "],
["map-of-the-reporting-districts-with-their-crimes.html", "Chapter 20 Map of the Reporting Districts with their Crimes", " Chapter 20 Map of the Reporting Districts with their Crimes We investigate the Crimes associated with the Reporting Districts. RDGeoLocationFull = LACrime %&gt;% group_by(ReportingDistrict) %&gt;% summarise(RDlat = median(latitude,na.rm = TRUE) ,RDlon = median(longitude,na.rm = TRUE) ,CountIncidents = n()) RD = readOGR(dsn = &quot;input/LAPD_Reporting_Districts.shp&quot;) ## OGR data source with driver: ESRI Shapefile ## Source: &quot;input/LAPD_Reporting_Districts.shp&quot;, layer: &quot;LAPD_Reporting_Districts&quot; ## with 1135 features ## It has 7 fields ## Integer64 fields read as strings: OBJECTID REPDIST PREC RD@data$REPDIST = as.numeric(RD@data$REPDIST ) RDGeoLocationFull$ReportingDistrict = as.numeric(RDGeoLocationFull$ReportingDistrict) RD@data = left_join(RD@data, RDGeoLocationFull, by = c(&quot;REPDIST&quot; = &quot;ReportingDistrict&quot;)) bins = c(0,1000,2000, 4000, 5000, 6000, 7000,8000, 9000) pal = colorBin(&quot;YlOrRd&quot;, domain = RD@data$CountIncidents, bins = bins) labels = sprintf( &quot;&lt;strong&gt;%s&lt;/strong&gt;&lt;br/&gt;%g&quot;, RD@data$REPDIST, RD@data$CountIncidents ) %&gt;% lapply(htmltools::HTML) center_lon = median(RD@data$RDlon,na.rm = TRUE) center_lat = median(RD@data$RDlat,na.rm = TRUE) leaflet(data = RD) %&gt;% setView(lng=center_lon, lat=center_lat, zoom=12) %&gt;% addPolygons( fillColor = ~pal(CountIncidents), weight = 2, opacity = 1, color = &quot;white&quot;, dashArray = &quot;3&quot;, fillOpacity = 0.7, highlight = highlightOptions( weight = 5, color = &quot;#666&quot;, dashArray = &quot;&quot;, fillOpacity = 0.7, bringToFront = TRUE), label = labels, labelOptions = labelOptions( style = list(&quot;font-weight&quot; = &quot;normal&quot;, padding = &quot;3px 8px&quot;), textsize = &quot;15px&quot;, direction = &quot;auto&quot;)) %&gt;% addLegend(pal = pal, values = ~CountIncidents, opacity = 0.7, title = &quot;Reporting Districts and Crimes&quot;, position = &quot;bottomleft&quot;) "],
["type-of-crime-analysis.html", "Chapter 21 Type of Crime Analysis", " Chapter 21 Type of Crime Analysis We examine the various types of Crime and plot the Top 20 Crimes in the bar plot. LACrime %&gt;% group_by(CrimeCodeDescription) %&gt;% tally() %&gt;% arrange(desc(n)) %&gt;% head(20) %&gt;% mutate(CrimeCodeDescription = reorder(CrimeCodeDescription,n)) %&gt;% ggplot(aes(x = CrimeCodeDescription,y = n)) + geom_bar(stat=&#39;identity&#39;,colour=&quot;white&quot;, fill =fillColor2) + geom_text(aes(x = CrimeCodeDescription, y = 1, label = paste0(&quot;(&quot;,n,&quot;)&quot;,sep=&quot;&quot;)), hjust=0, vjust=.5, size = 4, colour = &#39;black&#39;, fontface = &#39;bold&#39;) + labs(x = &#39;CrimeCodeDescription&#39;, y = &#39;Count of Incidents&#39;, title = &#39;Count of Incidents and CrimeCodeDescription&#39;) + coord_flip() + theme_bw() Battery - Simple Assault , Burglary from Vehicle , Vehicle -Stolen , Burglary and Theft -Plain Petty are among the most common crimes. "],
["type-of-crime-and-reporting-district.html", "Chapter 22 Type of Crime and Reporting District", " Chapter 22 Type of Crime and Reporting District We examine the various types of Crime happenning in the Reporting Districts. We plot the Top 20 items in the bar plot. LACrime %&gt;% group_by(CrimeCodeDescription,ReportingDistrict) %&gt;% tally() %&gt;% arrange(desc(n)) %&gt;% head(20) %&gt;% mutate(ReportingDistrict = reorder(ReportingDistrict,n)) %&gt;% ggplot(aes(x = ReportingDistrict,y = n,fill = CrimeCodeDescription)) + geom_bar(stat=&#39;identity&#39;,colour=&quot;white&quot;) + labs(x = &#39;ReportingDistrict&#39;, y = &#39;Count of Incidents&#39;, title = &#39;ReportingDistrict and CrimeCodeDescription&#39;) + coord_flip() + theme_bw() + theme(legend.position=&quot;top&quot;) Shoplifting Petty Theft and Theft Plain are the Top Two most Common Crimes. "],
["trend-of-crimes.html", "Chapter 23 Trend of Crimes", " Chapter 23 Trend of Crimes We examine the Trend of the Crimes from 2010 onwards LACrimeGroup = LACrime %&gt;% mutate(year_month = make_date(year=year(mdy(DateOccurred)),month=month(mdy(DateOccurred))) ) %&gt;% filter(!is.na(year_month)) %&gt;% group_by(year_month) %&gt;% summarize(CountCrimes = n()) LACrimeGroup %&gt;% filter(year_month != &quot;2017-09-01&quot;) %&gt;% ggplot(aes(x=year_month,y=CountCrimes)) + geom_line(size=.5, color=&quot;red&quot;)+geom_point(size=2, color=&quot;red&quot;)+theme_bw() The crimes are increasing from 2014 onwards. "],
["trend-of-battery-simple-assault.html", "Chapter 24 Trend of Battery - Simple Assault", " Chapter 24 Trend of Battery - Simple Assault We examine the Trend of the Crime Battery - Simple Assault from 2010 onwards. We choose this Crime Type since it is the most commonly occuring Crime Type.We exclude the last Month since it might be a outlier. LACrimeGroupBatterySA = LACrime %&gt;% filter(CrimeCode == 624) %&gt;% mutate(year_month = make_date(year=year(mdy(DateOccurred)),month=month(mdy(DateOccurred))) ) %&gt;% filter(!is.na(year_month)) %&gt;% filter(year_month != &quot;2017-09-01&quot;) %&gt;% group_by(year_month) %&gt;% summarize(CountCrimes = n()) LACrimeGroupBatterySA %&gt;% filter(year_month != &quot;2017-09-01&quot;) %&gt;% ggplot(aes(x=year_month,y=CountCrimes)) + geom_line(size=.5, color=&quot;red&quot;)+geom_point(size=2, color=&quot;red&quot;)+theme_bw() "],
["predictions-using-arima-for-battery-simple-assault.html", "Chapter 25 Predictions using ARIMA for Battery - Simple Assault", " Chapter 25 Predictions using ARIMA for Battery - Simple Assault We predict the Crimes for the Battery - Simple Assault for the months of September to December 2017 using ARIMA. CountOfCrimes = ts(LACrimeGroupBatterySA$CountCrimes) fit = auto.arima(CountOfCrimes,stepwise=FALSE, approximation=FALSE) predictions = fit %&gt;% forecast(h=4) predictions %&gt;% autoplot(include=80) +theme_bw() The predictions for months of September to December 2017 using ARIMA are shown here. Months Predictions September 2017 1573 October 2017 1445 November 2017 1360 December 2017 1312 "],
["predictions-using-ets-for-battery-simple-assault.html", "Chapter 26 Predictions using ETS for Battery - Simple Assault", " Chapter 26 Predictions using ETS for Battery - Simple Assault We predict the Crimes for the Battery - Simple Assault for the months of September to December 2017 using ETS. CountOfCrimes = ts(LACrimeGroupBatterySA$CountCrimes) fit = ets(CountOfCrimes) predictions = fit %&gt;% forecast(h=4) predictions %&gt;% autoplot(include=80) +theme_bw() The predictions for months of September to December 2017 using ETS are shown here. Months Predictions September 2017 1688 October 2017 1688 November 2017 1688 December 2017 1688 "],
["predictions-using-prophet-for-battery-simple-assault.html", "Chapter 27 Predictions using Prophet for Battery - Simple Assault", " Chapter 27 Predictions using Prophet for Battery - Simple Assault We predict the Crimes for the Battery - Simple Assault for the months of September to December 2017 using Prophet. colnames(LACrimeGroupBatterySA) = c(&quot;ds&quot;,&quot;y&quot;) m &lt;- prophet(LACrimeGroupBatterySA,changepoint.prior.scale = 0.1) ## Initial log joint probability = -2.43405 ## Optimization terminated normally: ## Convergence detected: relative gradient magnitude is below tolerance future &lt;- make_future_dataframe(m, periods = 4,freq = &quot;month&quot;) forecast &lt;- predict(m, future) predictionsValues = tail(forecast$yhat,4) dataSetCrimes = data.frame(Month = as.character(), CrimeCount = as.numeric()) dataSetMonths = data.frame(c(&quot;September 2017&quot;, &quot;October 2017&quot;, &quot;November 2017&quot;, &quot;December 2017&quot;)) dataSetCrimes = cbind(dataSetMonths,round(predictionsValues)) colnames(dataSetCrimes) = c(&quot;Months&quot;,&quot;Predictions&quot;) kable(dataSetCrimes,&quot;html&quot;) %&gt;% kable_styling(bootstrap_options = c(&quot;striped&quot;, &quot;hover&quot;, &quot;condensed&quot;, &quot;responsive&quot;)) Months Predictions September 2017 1562 October 2017 1609 November 2017 1387 December 2017 1393 "]
]
